@model Rio.Web.Modules.Workspace.CommonController.Models.RectifyModel.ScannedQuestionDatamodel
@inject Serenity.ITextLocalizer Localizer

@{
    ViewData["Title"] = "RectifyAnswers";
    ViewData["PageId"] = "Rectify";
    Layout = User.IsLoggedIn() ?
        "~/Views/Shared/_Layout.cshtml" :
        "~/Views/Shared/_LayoutNoNavigation.cshtml";
    int rowcount = @Model.ScanQuestionList.Count;
}

<div class="container">
    
   <lable>Corrected ExamNo</lable>
    <input type="text" id="CorrectedExamNo" value="@Model.ScanQuestionList[0].ScannedSheetCorrectedExamNo" />
    <br/>
    <lable>Corrected RollNo</lable>
    <input type="text" id="CorrectedRollNo" value="@Model.ScanQuestionList[0].ScannedSheetCorrectedRollNo" />
    <br/>
    <h5 style="text-align:center">
        Scanned Sheet Id: @Model.ScanQuestionList[0].ScannedSheetId  
    </h5>
    
    <br /><br />
    <div class="row" style="margin-bottom:10px;">
        <div class="col-md-6">
            
            <img width="100%" height="80%" src="~/uploads/@Model.ScanQuestionList[0].ScannedSheetScannedImage" />
            
        </div>
        <div class="col-md-6" style="overflow-y: scroll;height:600px;">
            <div class="row" style="margin-left:5px;">
                <div class="col-md-2">
                    <label> Question Index</label>
                </div>
                <div class="col-md-2">
                    <label> Scanned Option</label>
                </div>
                <div class="col-md-2">
                    <label> Corrected Option</label>
                </div>
            </div>
            @for (int i = 0; i < @Model.ScanQuestionList.Count; i++)
            {
                <div class="row" style="margin-left:5px;">
                    <div class="col-md-2">
                       <label>@Model.ScanQuestionList[i].QuestionIndex </label> 
                    </div>
                    <div class="col-md-2">
                        <label>@Model.ScanQuestionList[i].ScannedOptions </label>
                    </div>
                    <div class="col-md-2">
                        <input type="text" id="Correctoption@(i)" value="@Model.ScanQuestionList[i].CorrectedOptions"/>
                        <input type="hidden" id="ScannQuestion@(i)" value="@Model.ScanQuestionList[i].Id" />
                    </div>
                </div>
            }
        </div>

    </div>
    <button id="btnsave" style="float:left;margin-right:150px;" class="btn btn-info">Save Data</button>
    @if (!string.IsNullOrEmpty(Model.PrevScannedSheetId))
    {
        <button id="btnback" style="float:left;margin-right:150px;" class="btn btn-info">Previous</button>
    }
    @if (!string.IsNullOrEmpty(Model.NextScannedSheetId))
    {
        <button id="btnnext" style="float:left;margin-right:150px;" class="btn btn-info">Next</button>
    }
</div>

<script type="text/javascript">

    $("#btnsave").click(function () {
        var param = [];
        var CorrectedExamno = "";
        var CorrectedRollno = "";
        var Questionlist = "";
        if ($("#CorrectedExamNo").val() == "") {
            alert("Please Enter Corrected Exam number");
                    return;
        }
        if ($("#CorrectedRollNo").val() == "") {
            alert("Please Enter Corrected Roll number");
                    return;
        }
        for (var i = 0; i < parseInt("@rowcount"); i++) {
            var subid = "-1";
            var CorrectOption = "";
            CorrectOption = $("#Correctoption" + i.toString()).val();          

            Questionlist +=   CorrectOption + "#;#" + $("#ScannQuestion" + i.toString()).val() + "#$#";

        }

        CorrectedExamno = $("#CorrectedExamNo").val();
        CorrectedRollno = $("#CorrectedRollNo").val();
        $.post("UpdateScanQuestions", {
            
            "Questionlist": Questionlist, "CorrectedExamno": CorrectedExamno, "CorrectedRollno": CorrectedRollno, "ScannedSheetId": "@Model.ScanQuestionList[0].ScannedSheetId.ToString()"
        }, function (data) {
             Q.alert("Data Saved");
           
        });



    });
    function OpenWindowWithPostData(url, windowoption, name, params) {
        var form = document.createElement("form");
        form.setAttribute("method", "post");
        form.setAttribute("action", url);
        form.setAttribute("target", name);
        for (var i in params) {
            if (params.hasOwnProperty(i)) {
                var input = document.createElement('input');
                input.type = 'hidden';
                input.name = i;
                input.value = params[i];
                form.appendChild(input);
            }
        }
        document.body.appendChild(form);
        //window.open(url, name, windowoption);
        form.submit();
        document.body.removeChild(form);
    }
    $("#btnback").click(function () {
        var  PrevScannedSheetId="@Model.PrevScannedSheetId.ToString()";
        var param = {
            'ScannedSheetId': PrevScannedSheetId.toString()
        };
        var url = "/Rectify/ScanQuestions";
        OpenWindowWithPostData(url, "", "ScanQuestion", param);
    });

    $("#btnnext").click(function () {
        var NextScannedSheetId = "@Model.NextScannedSheetId";
        var param = {
            'ScannedSheetId': NextScannedSheetId.toString()
        };
        var url = "/Rectify/ScanQuestions";
        OpenWindowWithPostData(url, "", "ScanQuestion", param);
    });
        
</script>